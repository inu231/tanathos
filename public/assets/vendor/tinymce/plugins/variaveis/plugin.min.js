tinymce.PluginManager.add('variaveis', function(editor, url) {

    var tags = [
        { label : true, title : 'Informações do assinante' },
        { title : 'Link para visualizar', tags : '*|EMAIL_LINK|*' },
        { title : 'Link para descadastrar', tags : '*|UNSUBSCRIBE|*' },
        { title : 'Confirmar presença', tags : '*|CONFIRMAR|*' },
        { title : 'Link para confirmar presença', tags : '*|CONFIRMAR_LINK|*' },
        { title : 'Assunto', tags : '*|ASSUNTO|*' },
        { title : 'Nome do Evento', tags : '*|NOME_EVENTO|*' },
        { title : 'Cidade do Evento', tags : '*|CIDADE_EVENTO|*' },
        { title : 'Estado do Evento', tags : '*|ESTADO_EVENTO|*' },
        { title : 'Data do Evento', tags : '*|DATA_EVENTO|*' },
        { title : 'Data Final do Evento', tags : '*|DATA_FINAL_EVENTO|*' },
        { title : 'Unidade do Evento', tags : '*|UNIDADE_EVENTO|*' },
        { title : 'Nome do cadastro', tags : '*|NOME|*' },
        { title : 'Tratamento do cadastro', tags : '*|TRATAMENTO|*' },
        { title : 'Apelido do cadastro', tags : '*|APELIDO|*' },
        { title : 'Cargo do cadastro', tags : '*|CARGO|*' },
        { title : 'Email do cadastro', tags : '*|EMAIL|*' }
    ];

    editor.addButton('variaveis', {
        type: 'panelbutton',
        text: 'Variáveis',
        tooltip: 'Variáveis disponíveis para uso',
        panel: {
            role: 'application',
            autohide: true,
            html: getHtml,
            onclick: function(e) {
                var linkElm = editor.dom.getParent(e.target, 'li');

                if (linkElm) {
                    editor.insertContent(
                        linkElm.getAttribute('data-mce-tag')
                    );

                    this.hide();
                }
            }
        }
    });

    function getHtml() {
        var listHtml;

        listHtml = '<ul role="list" class="mce-menu">';

        tinymce.each(tags, function(row) {
            if (row.tags) {
                listHtml += '<li class="mce-menu-item" data-mce-tag="'+row.tags+'">'+row.title+'</li>';
            }
        });

        listHtml += '</ul>';

        return listHtml;
    }

});
